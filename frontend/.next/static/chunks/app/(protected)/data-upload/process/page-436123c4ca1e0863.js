(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[473],{7472:function(e,t,s){Promise.resolve().then(s.bind(s,1926))},5821:function(e,t,s){"use strict";s.d(t,{Z:function(){return l}});let l=(0,s(2289).Z)("cog",[["path",{d:"M12 20a8 8 0 1 0 0-16 8 8 0 0 0 0 16Z",key:"sobvz5"}],["path",{d:"M12 14a2 2 0 1 0 0-4 2 2 0 0 0 0 4Z",key:"11i496"}],["path",{d:"M12 2v2",key:"tus03m"}],["path",{d:"M12 22v-2",key:"1osdcq"}],["path",{d:"m17 20.66-1-1.73",key:"eq3orb"}],["path",{d:"M11 10.27 7 3.34",key:"16pf9h"}],["path",{d:"m20.66 17-1.73-1",key:"sg0v6f"}],["path",{d:"m3.34 7 1.73 1",key:"1ulond"}],["path",{d:"M14 12h8",key:"4f43i9"}],["path",{d:"M2 12h2",key:"1t8f8n"}],["path",{d:"m20.66 7-1.73 1",key:"1ow05n"}],["path",{d:"m3.34 17 1.73-1",key:"nuk764"}],["path",{d:"m17 3.34-1 1.73",key:"2wel8s"}],["path",{d:"m11 13.73-4 6.93",key:"794ttg"}]])},1926:function(e,t,s){"use strict";s.r(t);var l=s(3107),i=s(8396),a=s(6201),r=s(7973),d=s(8641),n=s(5821),c=s(8477),x=s(2861),h=s(4867),o=s(9339),m=s(9737),u=s(2692),p=s(5058);t.default=()=>{let[e,t]=(0,i.useState)(null),[g,f]=(0,i.useState)(null),[b,j]=(0,i.useState)([]),[w,N]=(0,i.useState)(!1),[v,y]=(0,i.useState)(null),[k,Z]=(0,i.useState)({}),C=(0,i.useRef)(null),E=async()=>{if(!e){y("업로드할 파일을 선택해주세요.");return}N(!0),y(null);try{let t=await Promise.all([s.e(531),s.e(381)]).then(s.bind(s,1999)),l=await e.arrayBuffer(),i=t.read(l,{type:"array"}),a=i.Sheets[i.SheetNames[0]],r=t.utils.decode_range(a["!ref"]||"A1"),d=[];for(let e=r.s.c;e<=r.e.c;e++){let s=a[t.utils.encode_cell({r:0,c:e})];s&&s.v&&d.push(s.v.toString().trim())}let n=t.utils.sheet_to_json(a,{header:d,range:1,defval:""}),c=n.map((e,t)=>({id:"process-".concat(t),originalData:e,modifiedData:{...e},isEditing:!1})),x={filename:e.name,fileSize:(e.size/1024/1024).toFixed(2),data:n,columns:d};f(x),j(c),y(null)}catch(e){console.error("파일 업로드 오류:",e),y("파일 업로드 중 오류가 발생했습니다.")}finally{N(!1)}},_=(e,t,s)=>{j(l=>l.map(l=>l.id===e?{...l,modifiedData:{...l.modifiedData,[t]:s}}:l))},z=e=>{j(t=>t.map(t=>t.id===e?{...t,isEditing:!t.isEditing}:t))},D=async e=>{let t=b.find(t=>t.id===e);if(t){if(!(k[e]||"").trim()){y("수정 사유를 입력해주세요.");return}try{j(t=>t.map(t=>t.id===e?{...t,isEditing:!1,originalData:{...t.modifiedData}}:t)),Z(t=>{let s={...t};return delete s[e],s}),y(null),console.log("행 저장 성공:",t.modifiedData)}catch(e){console.error("행 저장 오류:",e),y("행 저장 중 오류가 발생했습니다: ".concat(e))}}};return(0,l.jsx)(a.Z,{children:(0,l.jsxs)("div",{className:"w-full h-full p-4 lg:p-6 xl:p-8 space-y-4 lg:space-y-6 xl:space-y-8",children:[(0,l.jsxs)("div",{className:"flex items-center gap-4 mb-6",children:[(0,l.jsx)(p.default,{href:"/data-upload",children:(0,l.jsxs)(u.zx,{variant:"outline",className:"border-white/20 text-white/80 hover:bg-white/10",children:[(0,l.jsx)(r.Z,{className:"w-4 h-4 mr-2"}),"뒤로가기"]})}),(0,l.jsxs)("div",{children:[(0,l.jsx)("h1",{className:"stitch-h1 text-xl lg:text-2xl xl:text-3xl font-bold",children:"공정정보"}),(0,l.jsx)("p",{className:"stitch-caption text-white/60 text-xs lg:text-sm",children:"생산 공정의 세부 정보와 공정별 데이터를 체계적으로 관리합니다."})]})]}),(0,l.jsxs)("div",{className:"flex-1 min-h-0 space-y-6",children:[(0,l.jsxs)("div",{className:"stitch-card p-6",children:[(0,l.jsxs)("div",{className:"flex items-center gap-3 mb-4",children:[(0,l.jsx)("div",{className:"w-10 h-10 bg-orange-100 rounded-lg flex items-center justify-center",children:(0,l.jsx)(d.Z,{className:"w-5 h-5 text-orange-600"})}),(0,l.jsxs)("div",{children:[(0,l.jsx)("h2",{className:"text-lg font-semibold text-white",children:"템플릿 다운로드"}),(0,l.jsx)("p",{className:"text-sm text-white/60",children:"공정 데이터 입력을 위한 표준 템플릿을 다운로드하세요"})]})]}),(0,l.jsxs)(u.zx,{onClick:()=>{let e=document.createElement("a");e.href="/templates/실적_데이터_공정정보.xlsx",e.download="실적_데이터_공정정보.xlsx",document.body.appendChild(e),e.click(),document.body.removeChild(e)},className:"bg-orange-600 hover:bg-orange-700 text-white px-6 py-3 rounded-lg transition-colors",children:[(0,l.jsx)(d.Z,{className:"w-4 h-4 mr-2"}),"템플릿 다운로드"]})]}),(0,l.jsxs)("div",{className:"stitch-card p-6",children:[(0,l.jsxs)("div",{className:"flex items-center gap-3 mb-4",children:[(0,l.jsx)("div",{className:"w-10 h-10 bg-blue-100 rounded-lg flex items-center justify-center",children:(0,l.jsx)(n.Z,{className:"w-5 h-5 text-blue-600"})}),(0,l.jsxs)("div",{children:[(0,l.jsx)("h2",{className:"text-lg font-semibold text-white",children:"Excel 업로드"}),(0,l.jsx)("p",{className:"text-sm text-white/60",children:"공정 정보가 포함된 Excel 파일을 업로드하여 분석합니다"})]})]}),(0,l.jsxs)("div",{className:"border-2 border-dashed rounded-xl p-12 text-center transition-all duration-200 ".concat(e?"border-green-400 bg-green-50":"border-white/20 hover:border-primary hover:bg-white/5"),onDrop:e=>{e.preventDefault();let s=e.dataTransfer.files;if(s.length>0){let e=s[0];e.name.match(/\.(xlsx|xls)$/)?(t(e),y(null)):y("엑셀 파일만 업로드 가능합니다 (.xlsx, .xls)")}},onDragOver:e=>{e.preventDefault()},children:[(0,l.jsx)("input",{ref:C,type:"file",accept:".xlsx,.xls",onChange:e=>{var s;let l=null===(s=e.target.files)||void 0===s?void 0:s[0];if(l){if(!l.name.match(/\.(xlsx|xls)$/)){y("엑셀 파일만 업로드 가능합니다 (.xlsx, .xls)"),t(null);return}t(l),y(null),f(null),j([])}},className:"hidden"}),e?(0,l.jsxs)("div",{className:"space-y-4",children:[(0,l.jsx)("div",{className:"w-16 h-16 mx-auto bg-green-100 rounded-full flex items-center justify-center",children:(0,l.jsx)(c.Z,{className:"w-8 h-8 text-green-600"})}),(0,l.jsxs)("div",{children:[(0,l.jsxs)("p",{className:"text-lg font-medium text-white mb-2",children:["선택된 파일: ",e.name]}),(0,l.jsxs)("p",{className:"text-sm text-white/60 mb-4",children:["파일 크기: ",(e.size/1024/1024).toFixed(2)," MB"]}),(0,l.jsxs)("div",{className:"flex gap-3 justify-center",children:[(0,l.jsx)(u.zx,{onClick:E,disabled:w,className:"bg-green-600 hover:bg-green-700 text-white px-6 py-3 rounded-lg transition-colors disabled:opacity-50",children:w?"업로드 중...":"업로드 시작"}),(0,l.jsx)(u.zx,{onClick:()=>{t(null),f(null),j([])},className:"bg-gray-600 hover:bg-gray-700 text-white px-6 py-3 rounded-lg transition-colors",children:"파일 변경"})]})]})]}):(0,l.jsxs)("div",{className:"space-y-4",children:[(0,l.jsx)("div",{className:"w-16 h-16 mx-auto bg-white/10 rounded-full flex items-center justify-center",children:(0,l.jsx)(n.Z,{className:"w-8 h-8 text-white/60"})}),(0,l.jsxs)("div",{children:[(0,l.jsx)("p",{className:"text-lg font-medium text-white mb-2",children:"파일을 드래그하여 업로드하거나 클릭하여 선택하세요"}),(0,l.jsx)("p",{className:"text-sm text-white/60 mb-4",children:"지원 형식: .xlsx, .xls"}),(0,l.jsx)(u.zx,{onClick:()=>{var e;return null===(e=C.current)||void 0===e?void 0:e.click()},className:"bg-primary hover:bg-primary/90 text-white px-6 py-3 rounded-lg transition-colors",children:"파일 선택"})]})]})]})]}),g&&b.length>0&&(0,l.jsxs)("div",{className:"stitch-card p-6",children:[(0,l.jsx)("div",{className:"flex items-center justify-between mb-4",children:(0,l.jsxs)("div",{children:[(0,l.jsx)("h3",{className:"text-lg font-semibold text-white",children:"공정 데이터 미리보기"}),(0,l.jsxs)("p",{className:"text-sm text-white/60",children:["파일: ",g.filename," | 크기: ",g.fileSize," MB | 행 수: ",g.data.length]})]})}),(0,l.jsx)("div",{className:"overflow-x-auto",children:(0,l.jsxs)("table",{className:"w-full border-collapse border border-white/20",children:[(0,l.jsx)("thead",{children:(0,l.jsxs)("tr",{className:"bg-white/10",children:[g.columns.map(e=>(0,l.jsx)("th",{className:"border border-white/20 px-3 py-2 text-left text-sm font-medium text-white",children:e},e)),(0,l.jsx)("th",{className:"border border-white/20 px-3 py-2 text-left text-sm font-medium text-white",children:"작업"})]})}),(0,l.jsx)("tbody",{children:b.map(e=>(0,l.jsxs)("tr",{className:"border-b border-white/10 hover:bg-white/5",children:[g.columns.map(t=>(0,l.jsx)("td",{className:"border border-white/20 px-3 py-2 text-sm text-white",children:e.isEditing?(0,l.jsx)(u.II,{type:"text",value:e.modifiedData[t]||"",onChange:s=>_(e.id,t,s.target.value),className:"w-full px-2 py-1 bg-white/10 border border-white/20 rounded text-white focus:outline-none focus:ring-2 focus:ring-primary/50"}):(0,l.jsx)("span",{children:e.modifiedData[t]||"-"})},t)),(0,l.jsx)("td",{className:"border border-white/20 px-3 py-2 text-sm",children:e.isEditing?(0,l.jsxs)("div",{className:"flex gap-2",children:[(0,l.jsxs)(u.zx,{onClick:()=>D(e.id),className:"bg-green-600 hover:bg-green-700 text-white px-3 py-1 rounded text-xs",children:[(0,l.jsx)(x.Z,{className:"w-3 h-3 mr-1"}),"저장"]}),(0,l.jsxs)(u.zx,{onClick:()=>z(e.id),className:"bg-gray-600 hover:bg-gray-700 text-white px-3 py-1 rounded text-xs",children:[(0,l.jsx)(h.Z,{className:"w-3 h-3 mr-1"}),"취소"]})]}):(0,l.jsxs)(u.zx,{onClick:()=>z(e.id),className:"bg-blue-600 hover:bg-blue-700 text-white px-3 py-1 rounded text-xs",children:[(0,l.jsx)(o.Z,{className:"w-3 h-3 mr-1"}),"편집"]})})]},e.id))})]})}),b.some(e=>e.isEditing)&&(0,l.jsxs)("div",{className:"mt-4 p-4 bg-white/5 rounded-lg",children:[(0,l.jsx)("h4",{className:"text-sm font-medium text-white mb-2",children:"수정 사유 입력"}),(0,l.jsx)("div",{className:"flex gap-4",children:b.filter(e=>e.isEditing).map(e=>(0,l.jsxs)("div",{className:"flex-1",children:[(0,l.jsxs)("label",{className:"block text-xs text-white/60 mb-1",children:["행 ",e.id," 수정 사유"]}),(0,l.jsx)(u.II,{type:"text",value:k[e.id]||"",onChange:t=>Z(s=>({...s,[e.id]:t.target.value})),placeholder:"수정 사유를 입력하세요",className:"w-full px-3 py-2 bg-white/10 border border-white/20 rounded-lg text-white placeholder-white/40 focus:outline-none focus:ring-2 focus:ring-primary/50 focus:border-primary"})]},e.id))})]})]}),v&&(0,l.jsx)("div",{className:"stitch-card p-6 bg-red-500/10 border border-red-500/20",children:(0,l.jsxs)("div",{className:"flex items-center gap-3",children:[(0,l.jsx)("div",{className:"w-10 h-10 bg-red-100 rounded-lg flex items-center justify-center",children:(0,l.jsx)(m.Z,{className:"w-5 h-5 text-red-600"})}),(0,l.jsxs)("div",{children:[(0,l.jsx)("h3",{className:"text-lg font-semibold text-red-400",children:"오류 발생"}),(0,l.jsx)("p",{className:"text-sm text-red-300",children:v})]})]})})]})]})})}}},function(e){e.O(0,[341,757,567,201,817,327,309,691,744],function(){return e(e.s=7472)}),_N_E=e.O()}]);