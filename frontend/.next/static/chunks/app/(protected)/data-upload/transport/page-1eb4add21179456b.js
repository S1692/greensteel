(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[58],{2981:function(e,s,t){Promise.resolve().then(t.bind(t,9059))},5285:function(e,s,t){"use strict";t.d(s,{Z:function(){return l}});let l=(0,t(2289).Z)("truck",[["path",{d:"M14 18V6a2 2 0 0 0-2-2H4a2 2 0 0 0-2 2v11a1 1 0 0 0 1 1h2",key:"wrbu53"}],["path",{d:"M15 18H9",key:"1lyqi6"}],["path",{d:"M19 18h2a1 1 0 0 0 1-1v-3.65a1 1 0 0 0-.22-.624l-3.48-4.35A1 1 0 0 0 17.52 8H14",key:"lysw3i"}],["circle",{cx:"17",cy:"18",r:"2",key:"332jqn"}],["circle",{cx:"7",cy:"18",r:"2",key:"19iecd"}]])},9059:function(e,s,t){"use strict";t.r(s);var l=t(3107),i=t(8396),r=t(6201),a=t(7973),d=t(8641),c=t(5285),n=t(8477),x=t(2861),h=t(4867),o=t(9339),m=t(9737),u=t(2692),p=t(5058);s.default=()=>{let[e,s]=(0,i.useState)(null),[f,g]=(0,i.useState)(null),[j,b]=(0,i.useState)([]),[w,N]=(0,i.useState)(!1),[v,y]=(0,i.useState)(null),[k,C]=(0,i.useState)({}),E=(0,i.useRef)(null),_=async()=>{if(!e){y("업로드할 파일을 선택해주세요.");return}N(!0),y(null);try{let s=await Promise.all([t.e(531),t.e(381)]).then(t.bind(t,1999)),l=await e.arrayBuffer(),i=s.read(l,{type:"array"}),r=i.Sheets[i.SheetNames[0]],a=s.utils.decode_range(r["!ref"]||"A1"),d=[];for(let e=a.s.c;e<=a.e.c;e++){let t=r[s.utils.encode_cell({r:0,c:e})];t&&t.v&&d.push(t.v.toString().trim())}let c=s.utils.sheet_to_json(r,{header:d,range:1,defval:""}),n=c.map((e,s)=>({id:"transport-".concat(s),originalData:e,modifiedData:{...e},isEditing:!1})),x={filename:e.name,fileSize:(e.size/1024/1024).toFixed(2),data:c,columns:d};g(x),b(n),y(null)}catch(e){console.error("파일 업로드 오류:",e),y("파일 업로드 중 오류가 발생했습니다.")}finally{N(!1)}},D=(e,s,t)=>{b(l=>l.map(l=>l.id===e?{...l,modifiedData:{...l.modifiedData,[s]:t}}:l))},Z=e=>{b(s=>s.map(s=>s.id===e?{...s,isEditing:!s.isEditing}:s))},z=async e=>{let s=j.find(s=>s.id===e);if(s){if(!(k[e]||"").trim()){y("수정 사유를 입력해주세요.");return}try{b(s=>s.map(s=>s.id===e?{...s,isEditing:!1,originalData:{...s.modifiedData}}:s)),C(s=>{let t={...s};return delete t[e],t}),y(null),console.log("행 저장 성공:",s.modifiedData)}catch(e){console.error("행 저장 오류:",e),y("행 저장 중 오류가 발생했습니다: ".concat(e))}}};return(0,l.jsx)(r.Z,{children:(0,l.jsxs)("div",{className:"w-full h-full p-4 lg:p-6 xl:p-8 space-y-4 lg:space-y-6 xl:space-y-8",children:[(0,l.jsxs)("div",{className:"flex items-center gap-4 mb-6",children:[(0,l.jsx)(p.default,{href:"/data-upload",children:(0,l.jsxs)(u.zx,{variant:"outline",className:"border-white/20 text-white/80 hover:bg-white/10",children:[(0,l.jsx)(a.Z,{className:"w-4 h-4 mr-2"}),"뒤로가기"]})}),(0,l.jsxs)("div",{children:[(0,l.jsx)("h1",{className:"stitch-h1 text-xl lg:text-2xl xl:text-3xl font-bold",children:"운송정보"}),(0,l.jsx)("p",{className:"stitch-caption text-white/60 text-xs lg:text-sm",children:"원재료 및 제품의 운송 과정에서 발생하는 데이터를 관리합니다."})]})]}),(0,l.jsxs)("div",{className:"flex-1 min-h-0 space-y-6",children:[(0,l.jsxs)("div",{className:"stitch-card p-6",children:[(0,l.jsxs)("div",{className:"flex items-center gap-3 mb-4",children:[(0,l.jsx)("div",{className:"w-10 h-10 bg-purple-100 rounded-lg flex items-center justify-center",children:(0,l.jsx)(d.Z,{className:"w-5 h-5 text-purple-600"})}),(0,l.jsxs)("div",{children:[(0,l.jsx)("h2",{className:"text-lg font-semibold text-white",children:"템플릿 다운로드"}),(0,l.jsx)("p",{className:"text-sm text-white/60",children:"운송 데이터 입력을 위한 표준 템플릿을 다운로드하세요"})]})]}),(0,l.jsxs)(u.zx,{onClick:()=>{let e=document.createElement("a");e.href="/templates/실적_데이터_운송정보.xlsx",e.download="실적_데이터_운송정보.xlsx",document.body.appendChild(e),e.click(),document.body.removeChild(e)},className:"bg-purple-600 hover:bg-purple-700 text-white px-6 py-3 rounded-lg transition-colors",children:[(0,l.jsx)(d.Z,{className:"w-4 h-4 mr-2"}),"템플릿 다운로드"]})]}),(0,l.jsxs)("div",{className:"stitch-card p-6",children:[(0,l.jsxs)("div",{className:"flex items-center gap-3 mb-4",children:[(0,l.jsx)("div",{className:"w-10 h-10 bg-blue-100 rounded-lg flex items-center justify-center",children:(0,l.jsx)(c.Z,{className:"w-5 h-5 text-blue-600"})}),(0,l.jsxs)("div",{children:[(0,l.jsx)("h2",{className:"text-lg font-semibold text-white",children:"Excel 업로드"}),(0,l.jsx)("p",{className:"text-sm text-white/60",children:"운송 정보가 포함된 Excel 파일을 업로드하여 분석합니다"})]})]}),(0,l.jsxs)("div",{className:"border-2 border-dashed rounded-xl p-12 text-center transition-all duration-200 ".concat(e?"border-green-400 bg-green-50":"border-white/20 hover:border-primary hover:bg-white/5"),onDrop:e=>{e.preventDefault();let t=e.dataTransfer.files;if(t.length>0){let e=t[0];e.name.match(/\.(xlsx|xls)$/)?(s(e),y(null)):y("엑셀 파일만 업로드 가능합니다 (.xlsx, .xls)")}},onDragOver:e=>{e.preventDefault()},children:[(0,l.jsx)("input",{ref:E,type:"file",accept:".xlsx,.xls",onChange:e=>{var t;let l=null===(t=e.target.files)||void 0===t?void 0:t[0];if(l){if(!l.name.match(/\.(xlsx|xls)$/)){y("엑셀 파일만 업로드 가능합니다 (.xlsx, .xls)"),s(null);return}s(l),y(null),g(null),b([])}},className:"hidden"}),e?(0,l.jsxs)("div",{className:"space-y-4",children:[(0,l.jsx)("div",{className:"w-16 h-16 mx-auto bg-green-100 rounded-full flex items-center justify-center",children:(0,l.jsx)(n.Z,{className:"w-8 h-8 text-green-600"})}),(0,l.jsxs)("div",{children:[(0,l.jsxs)("p",{className:"text-lg font-medium text-white mb-2",children:["선택된 파일: ",e.name]}),(0,l.jsxs)("p",{className:"text-sm text-white/60 mb-4",children:["파일 크기: ",(e.size/1024/1024).toFixed(2)," MB"]}),(0,l.jsxs)("div",{className:"flex gap-3 justify-center",children:[(0,l.jsx)(u.zx,{onClick:_,disabled:w,className:"bg-green-600 hover:bg-green-700 text-white px-6 py-3 rounded-lg transition-colors disabled:opacity-50",children:w?"업로드 중...":"업로드 시작"}),(0,l.jsx)(u.zx,{onClick:()=>{s(null),g(null),b([])},className:"bg-gray-600 hover:bg-gray-700 text-white px-6 py-3 rounded-lg transition-colors",children:"파일 변경"})]})]})]}):(0,l.jsxs)("div",{className:"space-y-4",children:[(0,l.jsx)("div",{className:"w-16 h-16 mx-auto bg-white/10 rounded-full flex items-center justify-center",children:(0,l.jsx)(c.Z,{className:"w-8 h-8 text-white/60"})}),(0,l.jsxs)("div",{children:[(0,l.jsx)("p",{className:"text-lg font-medium text-white mb-2",children:"파일을 드래그하여 업로드하거나 클릭하여 선택하세요"}),(0,l.jsx)("p",{className:"text-sm text-white/60 mb-4",children:"지원 형식: .xlsx, .xls"}),(0,l.jsx)(u.zx,{onClick:()=>{var e;return null===(e=E.current)||void 0===e?void 0:e.click()},className:"bg-primary hover:bg-primary/90 text-white px-6 py-3 rounded-lg transition-colors",children:"파일 선택"})]})]})]})]}),f&&j.length>0&&(0,l.jsxs)("div",{className:"stitch-card p-6",children:[(0,l.jsx)("div",{className:"flex items-center justify-between mb-4",children:(0,l.jsxs)("div",{children:[(0,l.jsx)("h3",{className:"text-lg font-semibold text-white",children:"운송 데이터 미리보기"}),(0,l.jsxs)("p",{className:"text-sm text-white/60",children:["파일: ",f.filename," | 크기: ",f.fileSize," MB | 행 수: ",f.data.length]})]})}),(0,l.jsx)("div",{className:"overflow-x-auto",children:(0,l.jsxs)("table",{className:"w-full border-collapse border border-white/20",children:[(0,l.jsx)("thead",{children:(0,l.jsxs)("tr",{className:"bg-white/10",children:[f.columns.map(e=>(0,l.jsx)("th",{className:"border border-white/20 px-3 py-2 text-left text-sm font-medium text-white",children:e},e)),(0,l.jsx)("th",{className:"border border-white/20 px-3 py-2 text-left text-sm font-medium text-white",children:"작업"})]})}),(0,l.jsx)("tbody",{children:j.map(e=>(0,l.jsxs)("tr",{className:"border-b border-white/10 hover:bg-white/5",children:[f.columns.map(s=>(0,l.jsx)("td",{className:"border border-white/20 px-3 py-2 text-sm text-white",children:e.isEditing?(0,l.jsx)(u.II,{type:"text",value:e.modifiedData[s]||"",onChange:t=>D(e.id,s,t.target.value),className:"w-full px-2 py-1 bg-white/10 border border-white/20 rounded text-white focus:outline-none focus:ring-2 focus:ring-primary/50"}):(0,l.jsx)("span",{children:e.modifiedData[s]||"-"})},s)),(0,l.jsx)("td",{className:"border border-white/20 px-3 py-2 text-sm",children:e.isEditing?(0,l.jsxs)("div",{className:"flex gap-2",children:[(0,l.jsxs)(u.zx,{onClick:()=>z(e.id),className:"bg-green-600 hover:bg-green-700 text-white px-3 py-1 rounded text-xs",children:[(0,l.jsx)(x.Z,{className:"w-3 h-3 mr-1"}),"저장"]}),(0,l.jsxs)(u.zx,{onClick:()=>Z(e.id),className:"bg-gray-600 hover:bg-gray-700 text-white px-3 py-1 rounded text-xs",children:[(0,l.jsx)(h.Z,{className:"w-3 h-3 mr-1"}),"취소"]})]}):(0,l.jsxs)(u.zx,{onClick:()=>Z(e.id),className:"bg-blue-600 hover:bg-blue-700 text-white px-3 py-1 rounded text-xs",children:[(0,l.jsx)(o.Z,{className:"w-3 h-3 mr-1"}),"편집"]})})]},e.id))})]})}),j.some(e=>e.isEditing)&&(0,l.jsxs)("div",{className:"mt-4 p-4 bg-white/5 rounded-lg",children:[(0,l.jsx)("h4",{className:"text-sm font-medium text-white mb-2",children:"수정 사유 입력"}),(0,l.jsx)("div",{className:"flex gap-4",children:j.filter(e=>e.isEditing).map(e=>(0,l.jsxs)("div",{className:"flex-1",children:[(0,l.jsxs)("label",{className:"block text-xs text-white/60 mb-1",children:["행 ",e.id," 수정 사유"]}),(0,l.jsx)(u.II,{type:"text",value:k[e.id]||"",onChange:s=>C(t=>({...t,[e.id]:s.target.value})),placeholder:"수정 사유를 입력하세요",className:"w-full px-3 py-2 bg-white/10 border border-white/20 rounded-lg text-white placeholder-white/40 focus:outline-none focus:ring-2 focus:ring-primary/50 focus:border-primary"})]},e.id))})]})]}),v&&(0,l.jsx)("div",{className:"stitch-card p-6 bg-red-500/10 border border-red-500/20",children:(0,l.jsxs)("div",{className:"flex items-center gap-3",children:[(0,l.jsx)("div",{className:"w-10 h-10 bg-red-100 rounded-lg flex items-center justify-center",children:(0,l.jsx)(m.Z,{className:"w-5 h-5 text-red-600"})}),(0,l.jsxs)("div",{children:[(0,l.jsx)("h3",{className:"text-lg font-semibold text-red-400",children:"오류 발생"}),(0,l.jsx)("p",{className:"text-sm text-red-300",children:v})]})]})})]})]})})}}},function(e){e.O(0,[341,757,567,201,817,327,309,691,744],function(){return e(e.s=2981)}),_N_E=e.O()}]);